

<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>一个球</title>

	<style type="text/css">
	*{
    margin:             0;
    padding:            0;
	}

	a{
    display:            block;
    height:             50px;
    width:              50px;
    background:         red;
    border-radius:      25px;
    position:           absolute;
    top:                20px;
    left:               20px;
	}
  a:hover{
    background:         #48A65F;
	}
  a:active{
    background:         #AF191B;
	}
	</style>

	<!-- css 结束 -->

	<script type="text/javascript">
		window.onload = function () {
			var oCircle = document.getElementsByTagName('a')[0];
			fnDrag(oCircle);
			fnMove(oCircle,12,20);

			/*一个球的运动*/
			function fnMove (obj,iSpeedX,iSpeedY) {
				//alert("a");
				//var iSpeedX = speedX;
				//var iSpeedY = speedY;

			  clearInterval(obj.timer);
				obj.timer = setInterval(function () {

					iSpeedY += 3; //这个加速度一定要放最前面
					var left = iSpeedX + obj.offsetLeft;
				  var top = iSpeedY + obj.offsetTop;
				  var disX =  document.documentElement.clientWidth - obj.offsetWidth;
				  var disY = document.documentElement.clientHeight - obj.offsetHeight;

				  //iSpeedY += 3; //放这里最后会,y方向速度到不了零了..这尼玛的bug

					if(top >= disY){
						iSpeedY *= -0.8;
						iSpeedX *= 0.8;
						top = disY;
					}
					else if (top <= 0) {
						iSpeedY *= -0.8;
						iSpeedX *= 0.8;
						top = 0;
					}
				 if (left >= disX) {
						iSpeedX *= -1;
						//iSpeedY *= 0.8
						left = disX;
					}	
					else if(left <= 0){
						iSpeedX *= -1;
						//iSpeedY *= 0.8;
						left = 0;
					}

					if (Math.abs(iSpeedY) < 1) {
						iSpeedY = 0;
					}
					if (Math.abs(iSpeedX) < 1) {
						iSpeedX = 0;
					}

					if (iSpeedX == 0 && iSpeedY == 0 && top == disY) {
						clearInterval(obj.timer);
					};

					obj.style.left = left  + 'px';
					obj.style.top = top  + 'px';

					//document.title=iSpeedX + ',' + iSpeedY;
				},30);
			}

			

			/*拖拽*/
			function fnDrag (obj) {
				var lastX = 0;
				var lastY = 0;
				obj.onmousedown = function (ev) {
						var oEvent = ev || window.event;
						var disX = oEvent.clientX - obj.offsetLeft;
						var disY = oEvent.clientY - obj.offsetTop;


						document.onmousemove =function (ev) {
							var oEvent2 = ev || window.event;
							var left = oEvent2.clientX - disX;
							var top = oEvent2.clientY - disY;

							//物体与屏幕之间的最大距离
							var iMaxDisX = document.documentElement.clientWidth - obj.offsetWidth;
							var iMaxDisY = document.documentElement.clientHeight - obj.offsetHeight;

							if (left < 0) {
								left = 0;
							}
							else if(left > iMaxDisX){
								left = iMaxDisX;
							}
							if (top < 0) {
								top = 0;
							}
							else if (top > iMaxDisY ) {
								top = iMaxDisY;
							}


							obj.style.left = left + 'px';
							obj.style.top = top + 'px';

							iSpeedX = left - lastX;
							iSpeedY = top - lastY;
							lastX = left;
							lastY = top;
						};
						document.onmouseup = function () {
							document.onmousemove = null;
							document.onmousedown = null;
							document.onmouseup = null;

							/*传递速度*/
							fnMove(obj,iSpeedX,iSpeedY);
						};

						clearInterval(obj.timer); //按下鼠标停止运动

						return false;  //阻止默认事件
					};
			}

	};
	</script>

	<!-- js 结束 -->

</head>
<body>
	<a href="javascript:;"></a>
</body>
</html>