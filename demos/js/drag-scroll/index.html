
	
			<!DOCTYPE html>
<head>
<style>
*{margin: 0;padding: 0}
#div {width:20px; height:100px; background:#CCC; position:relative;top: 0;left: 130px; margin:50px auto;}
#div1 {width:20px; height:20px; background:red; cursor:pointer; position:absolute;}
#div2 {width:200px; height:300px; border:1px solid black; position:relative;top: -150px; overflow:hidden;margin: 0 auto;}
#div3 {position:absolute;}
#div4 {width: 200px; height: 20px; background: red;cursor: pointer;position: absolute;opacity: 0.2;}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
</head>
<body>
<div id="div">
	<div id="div1">
    </div>
</div>
<div id="div2">
	<div id="div3">
	<br />
    	开始位置<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	测试<br />
    	结束位置
    </div>
    <div id="div4"></div>
</div>


<script>
function myAddEvent(obj, sEvent, fn)
{
	if(obj.attachEvent)
	{
		obj.attachEvent('on'+sEvent, fn);
	}
	else
	{
		obj.addEventListener(sEvent, fn, false);
	}
}

	var oDiv=document.getElementById('div');
	var oDiv1=document.getElementById('div1');
	var oDiv2=document.getElementById('div2');
	var oDiv3=document.getElementById('div3');
	var oDiv4=document.getElementById('div4');
	function onMouseWheel(ev)
	{
		var oEvent=ev||event;
		var bDown=true;
		bDown=oEvent.wheelDelta?oEvent.wheelDelta<0:oEvent.detail>0;
		if(bDown)
		{
			setTop(oDiv1.offsetTop+10,oDiv1,oDiv3);
		}
		else
		{
			setTop(oDiv1.offsetTop-10,oDiv1,oDiv3);
		}
		if(oEvent.preventDefault)
		{
			oEvent.preventDefault();
		}
		return false;
	}
	/*绑定滚轮事件*/
	myAddEvent(oDiv, 'mousewheel', onMouseWheel);
	myAddEvent(oDiv, 'DOMMouseScroll', onMouseWheel);
	myAddEvent(oDiv2, 'mousewheel', onMouseWheel);
	myAddEvent(oDiv2, 'DOMMouseScroll', onMouseWheel);
	fnDrag(oDiv1);
	fnDrag(oDiv4);
	function setTop(t,obj)
	{
		if(t<0)
		{
			t=0;
		}
		else if(t>obj.parentNode.offsetHeight-obj.offsetHeight)
		{
			t=obj.parentNode.offsetHeight-obj.offsetHeight;
		}
		obj.style.top=t+'px';
		var scale=t / (obj.parentNode.offsetHeight-obj.offsetHeight);
		oDiv3.style.top=(oDiv3.parentNode.offsetHeight-oDiv3.offsetHeight)*scale+'px';
		document.title=scale;
	}

 function fnDrag (obj) {
	obj.onmousedown = function (ev) {
			var oEvent = ev || window.event;
			//计算鼠标点击物体的距离
			// var disX = oEvent.clientX - obj.offsetLeft;
			var disY = oEvent.clientY - obj.offsetTop;
			if (obj.setCapture) {          //是否是IE,捕获事件
				obj.onmousemove =fnMove;
			  obj.onmouseup = fnUp;
			  obj.setCapture();
		  }else{
		  	document.onmousemove = fnMove;
		  	document.onmouseup = fnUp;
		  }
			function fnMove(ev) {
				var oEvent2 = ev || window.event;
				//计算移动后物体的位置
				// var left = oEvent2.clientX - disX;
				var top = oEvent2.clientY - disY;

				//可拖动范围
				// var iMaxDisX = obj.parentNode.offsetWidth - obj.offsetWidth;
				var iMaxDisY = obj.parentNode.offsetHeight - obj.offsetHeight;

				// scaleX = left / iMaxDisX;
			 scaleY = top / iMaxDisY;

				var t = scaleY * (oDiv1.parentNode.offsetHeight - oDiv1.offsetHeight);
				setTop(t,oDiv1);
				// if (left < 0) {
				// 	left = 0;
				// }
				// else if(left > iMaxDisX){
				// 	left = iMaxDisX;
				// }
				if (top < 0) {
					top = 0;
				}
				else if (top > iMaxDisY ) {
					top = iMaxDisY;
				}
				// obj.style.left = left + 'px';
				obj.style.top = top + 'px';
			}
			function fnUp() {
				this.onmousemove = null;
				//this.onmousedown = null;
				this.onmouseup = null;
				if (this.releaseCapture) {  //IE，消除捕获事件
					this.releaseCapture();
				}
			}
			return false;  //阻止默认事件
		};
}
</script>
</body>
</html>

		
	